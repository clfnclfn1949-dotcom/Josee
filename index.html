<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>RIVAL; REVIVAL</title>
    <style>
        :root { --navy: #0A1931; --yellow: #FFC947; --white: #FFFFFF; }
        body { background: #F2F2F2; font-family: sans-serif; margin: 0; padding: 0; }
        nav { background: var(--navy); padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; color: white; }
        .nav-links a { color: white; margin-right: 20px; cursor: pointer; text-decoration: none; font-weight: bold; font-size: 0.9rem; }
        header { background: var(--navy); color: var(--yellow); padding: 40px; text-align: center; border-bottom: 5px solid var(--yellow); }
        .container { max-width: 800px; margin: 30px auto; padding: 20px; }
        .card { background: white; padding: 30px; margin-bottom: 20px; border: 1px solid #ddd; }
        .hidden { display: none; }
        input, textarea, select { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; }
        .btn { background: var(--navy); color: var(--yellow); border: none; padding: 12px; cursor: pointer; width: 100%; font-weight: bold; }
        
        /* 비밀 금고 핵심 스타일 */
        .vault-box { background: #f9f9f9; border: 2px dashed var(--navy); padding: 20px; text-align: center; margin: 10px 0; }
        .vault-data { filter: blur(10px); opacity: 0.2; transition: 0.5s; font-size: 1.5rem; font-weight: bold; }
        .vault-data.visible { filter: blur(0); opacity: 1; }
    </style>
</head>
<body>

<nav>
    <div class="nav-links">
        <a onclick="go('home')">HOME</a>
        <a onclick="go('writer')">WRITER</a>
        <a onclick="go('reader')">READER</a>
        <a onclick="go('mypage')">MY PAGE</a>
        <a onclick="go('admin')" id="nav-admin" style="display:none;">ADMIN</a>
    </div>
    <div id="user-status"></div>
</nav>

<header>
    <h1>RIVAL, RE; VIVAL</h1>
    <p>BAUHAUS INSPIRED PUBLISHING PLATFORM</p>
</header>

<div class="container">
    <div id="page-home" class="page">
        <div id="login-form" class="card">
            <h3>LOGIN / JOIN</h3>
            <input type="text" id="uid" placeholder="아이디">
            <input type="password" id="upw" placeholder="비밀번호">
            <button class="btn" onclick="login()">로그인</button>
            <hr style="margin:20px 0;">
            <input type="text" id="reg-id" placeholder="새 아이디">
            <input type="text" id="reg-name" placeholder="이름">
            <select id="reg-role"><option value="writer">작가</option><option value="reader">독자</option></select>
            <button class="btn" style="background:#ddd; color:#333;" onclick="signup()">회원가입</button>
        </div>
        <div id="welcome-msg" class="card hidden">
            <h2 id="hello-text"></h2>
            <p>"본 플랫폼은 관리자조차 수치를 열람할 수 없는 작가 보호 시스템을 운영합니다."</p>
        </div>
    </div>

    <div id="page-writer" class="page hidden">
        <div class="card">
            <h3>원고 투고</h3>
            <input type="text" id="title" placeholder="제목">
            <textarea id="content" rows="10" placeholder="내용"></textarea>
            <button class="btn" onclick="submitNovel()">투고하기</button>
        </div>
    </div>

    <div id="page-reader" class="page hidden">
        <div class="card">
            <h3>투고된 원고 리스트</h3>
            <div id="novel-list"></div>
        </div>
    </div>

    <div id="page-mypage" class="page hidden">
        <div class="card">
            <h3>나의 대시보드</h3>
            <div id="my-novels"></div>
        </div>
    </div>

    <div id="page-admin" class="page hidden">
        <div class="card">
            <h3>관리자 모드 (수치 봉인 중)</h3>
            <div id="admin-list"></div>
        </div>
    </div>
</div>

<script>
    let users = JSON.parse(localStorage.getItem('users')) || [];
    let novels = JSON.parse(localStorage.getItem('novels')) || [];
    let me = JSON.parse(localStorage.getItem('me')) || null;

    function go(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
        document.getElementById('page-' + pageId).classList.remove('hidden');
        if(pageId === 'reader') renderNovels();
        if(pageId === 'mypage') renderMyPage();
        if(pageId === 'admin') renderAdmin();
        checkUser();
    }

    function signup() {
        const id = document.getElementById('reg-id').value;
        const name = document.getElementById('reg-name').value;
        const role = document.getElementById('reg-role').value;
        if(!id || !name) return alert("입력 오류");
        users.push({id, name, role, pw: document.getElementById('upw').value});
        localStorage.setItem('users', JSON.stringify(users));
        alert("가입 완료!");
    }

    function login() {
        const id = document.getElementById('uid').value;
        const pw = document.getElementById('upw').value;
        if(id === 'admin' && pw === 'kt91107361!') {
            me = {id: 'admin', name: '관리자', role: 'admin'};
        } else {
            const user = users.find(u => u.id === id);
            if(!user) return alert("회원정보 없음");
            me = user;
        }
        localStorage.setItem('me', JSON.stringify(me));
        checkUser();
    }

    function logout() {
        me = null;
        localStorage.removeItem('me');
        location.reload();
    }

    function checkUser() {
        const status = document.getElementById('user-status');
        if(me) {
            status.innerHTML = `${me.name}님 [ <a onclick="logout()" style="color:white; cursor:pointer;">LOGOUT</a> ]`;
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('welcome-msg').classList.remove('hidden');
            document.getElementById('hello-text').innerText = `WELCOME, ${me.name}.`;
            if(me.id === 'admin') document.getElementById('nav-admin').style.display = 'inline-block';
        } else {
            status.innerHTML = "로그인이 필요합니다.";
        }
    }

    function submitNovel() {
        if(!me || me.role !== 'writer') return alert("작가만 가능");
        novels.push({id: Date.now(), authorId: me.id, author: me.name, title: document.getElementById('title').value, content: document.getElementById('content').value, stars: 0});
        localStorage.setItem('novels', JSON.stringify(novels));
        alert("투고 완료");
        go('reader');
    }

    function renderNovels() {
        const area = document.getElementById('novel-list');
        area.innerHTML = novels.map(n => `
            <div style="border-bottom:1px solid #eee; padding:10px;">
                <b>『${n.title}』</b> - ${n.author} 
                <button onclick="addStar(${n.id})" style="float:right;">별점 던지기</button>
            </div>
        `).join('');
    }

    function addStar(id) {
        const idx = novels.findIndex(n => n.id === id);
        novels[idx].stars += 1;
        localStorage.setItem('novels', JSON.stringify(novels));
        alert("별점 반영!");
    }

    function renderMyPage() {
        const area = document.getElementById('my-novels');
        if(!me) return;
        const my = novels.filter(n => n.authorId === me.id);
        area.innerHTML = my.map(n => `
            <div class="vault-box">
                <b>『${n.title}』</b>
                <div id="v-${n.id}" class="vault-data">★ ${n.stars}</div>
                <button onclick="document.getElementById('v-${n.id}').classList.toggle('visible')">자존심 금고 열기/닫기</button>
            </div>
        `).join('') || "투고 내역이 없습니다.";
    }

    function renderAdmin() {
        const area = document.getElementById('admin-list');
        area.innerHTML = novels.map(n => `<div>『${n.title}』 - [관리자 수치 봉인됨]</div>`).join('');
    }

    checkUser();
</script>

</body>
</html>
